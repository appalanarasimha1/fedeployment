<!-- <div class="document">
  <h4>{{document.title}}</h4>
  <a href="/nuxeo/nxdoc/default/{{document.uid}}/view_documents">
    <img src="{{document.contextParameters?.thumbnail.url}}" /> 
  </a>
</div> -->
<app-loader [show]="showLoader"></app-loader>
<section>
  <section>
    <div *ngIf="recentlyViewed && recentlyViewed.length && !videos.length && !images.length && !docs.length" class="container">
      <div class="row flexible" style="justify-content: space-between;">
        <div class="col-xl-4 col-md-4 mb-4">
          <h2 class=" commonHeading">Recently viewed</h2>
        </div>
        <div class="col-xl-2 col-md-2 mb-4">
          <p (click)="clearRecentlyViewed()" class="clear">Clear</p>
        </div>
        <div class="col-xl-12 col-md-12">
          <ul class="set-width portfolio-list" style="list-style: none;margin: unset; padding: 0; align-items: unset;">
            <li *ngFor="let file of recentlyViewed; let i = index">
              <!-- <a (click)="open(preview, file)">
                <img src="{{findOriginalUrlFromRenditions(file.contextParameters.renditions)}}"
                  class="w-100 shadow-1-strong rounded" alt="">
              </a> -->


              <div class="cardBlock pa-0" >
                <div class="cardBlockContent">
                  <div class="row">
                    <div (click)="open(preview, file)" class="col-xl-12 col-md-12">
                        <img src="{{getAssetUrl(file.contextParameters.thumbnail.url)}}" class="w-100 shadow-1-strong" alt=""/>
                        <!-- <img src="{{getAssetUrl(file.contextParameters.thumbnail.url)}}" class="w-100 shadow-1-strong rounded" alt=""> -->
                    </div>
                  </div>
                </div>
                <div class="cardBlockContentHover">
                  <ol>
                    <li>
                      <div class="form-group-custom">
                        <input type="checkbox" id="html{{i}}" [checked]="file.isSelected" [(ngModel)]="file.isSelected" (change)="selectImage($event, file, i, true)">
                        <label for="html{{i}}"></label>
                      </div>
                    </li>
                    <li>
                      <div class="hover-icon-group">
                        <div class="hover-icon star-icon"></div>
                        <div class="hover-icon plus-icon" (click)="open(preview, file)"></div>
                        <a class="hover-icon download-icon" href="{{findOriginalUrlFromViews(file.properties['picture:views'])}}"></a>
                      </div>
                    </li>
                  </ol>
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <section class="search-subpage pt-2 pb-5">
    <div *ngIf="!videos.length && !images.length && !docs.length && (!recentlyViewed || !recentlyViewed.length)" class="row">
      <div class="col-xl-12 col-md-12 ">
        <h2 class="noresult">No results available!</h2>
      </div>
    </div>
    <div *ngIf="videos.length || images.length || docs.length" class="container">
      <div class="row flexible" style="justify-content: space-between;">
        <div class="col-xl-4">
          <!-- <p class="pb-3 searchP">Traveller</p> TODO: pass search term from sub-header to search and then to here -->
          <!-- <div class="dropdown mb-4">
          <select class="btn" style="    background-color: white;
          height: 44px;
          text-align: left;
          padding: 0px 8px !important;" (change)="dropdownMenu($event)">
            <option class="dropdown-item" value='' selected>All assets</option>
            <option class="dropdown-item" value='dc:created'>Created</option>
            <option class="dropdown-item" value='dc:modified'>Modified</option>
            <option class="dropdown-item" value='dc:lastContributor'>Last Contibutor</option>
            <option class="dropdown-item" value='state'>State</option>
            <option class="dropdown-item" value='dc:nature'>Nature</option>
            <option class="dropdown-item" value='dc:coverage'>Coverage</option>
          </select>
        </div> -->


          <div ngbDropdown class="d-inline-block mb-4 assetsDropdown" (change)="dropdownMenu($event)">
            <button class="btn" id="dropdownBasic4" ngbDropdownToggle>All assets</button>
            <div ngbDropdownMenu aria-labelledby="dropdownBasic4">
              <button ngbDropdownItem value='dc:created'>Created</button>
              <button ngbDropdownItem value='dc:modified'>Modified</button>
              <button ngbDropdownItem value='dc:lastContributor'>Last Contibutor</button>
              <button ngbDropdownItem value='state'>State</button>
              <button ngbDropdownItem value='dc:nature'>Nature</button>
              <button ngbDropdownItem value='dc:coverage'>Coverage</button>
            </div>
          </div>
        </div>
        <div class="col-xl-4">
          <div id="view" class="e-btn-group flexible">
            <div>
              <input type="radio" (change)="viewChange($event)" id="left" name="align" value="gallery" />
              <label class="e-btn" for="left"><img src="../../assets/images/gallery view.png"
                  style="width: 30px;"></label>
            </div>
            <div>
              <input type="radio" (change)="viewChange($event)" id="right" name="align" value="list" />
              <label class="e-btn" for="right"><img src="../../assets/images/list view.png"
                  style="width: 30px;"></label>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="images.length" class="row">
        <div class="col-xl-12 flexible" style="justify-content: space-between;">
          <p class="imgHead pb-4">Images</p>
          <a class="fileCount pb-4">{{images.length}} images</a>
        </div>
        <!-- Gallery -->

        <ul *ngIf="!showListView" class="set-width portfolio-list"
          style="list-style: none;margin: unset; padding: 0; align-items: unset;">
          <li *ngFor="let image of images.slice(0, imageSliceInput); let i = index">

            <!-- <button class="btn btn-lg btn-outline-primary" (click)="open()">Launch demo modal</button> -->
            <!-- <a (click)="open(preview, image)">
              <img src="{{getAssetUrl(image.contextParameters.thumbnail.url)}}" class="w-100 shadow-1-strong rounded"
                alt="">
            </a> -->

            <div class="cardBlock pa-0" style="">
              <div class="cardBlockContent">
                <div class="row">
                  <div (click)="open(preview, image)" class="col-xl-12 col-md-12">
                      <img src="{{getAssetUrl(image.contextParameters.thumbnail.url)}}" class="w-100 shadow-1-strong" alt=""/>
                      <!-- <img src="{{getAssetUrl(image.contextParameters.thumbnail.url)}}" class="w-100 shadow-1-strong rounded" alt=""> -->
                  </div>
                </div>
              </div>
              <div class="cardBlockContentHover">
                <ol>
                  <li>
                    <div class="form-group-custom">
                      <input type="checkbox" id="html{{i}}"  [checked]="image.isSelected" [(ngModel)]="image.isSelected" (change)="selectImage($event, image, i)">
                      <label for="html{{i}}"></label>
                    </div>
                  </li>
                  <li>
                    <div class="hover-icon-group">
                      <div class="hover-icon star-icon"></div>
                      <div class="hover-icon plus-icon" (click)="open(preview, image)"></div>
                      <a class="hover-icon download-icon" href="{{findOriginalUrlFromViews(image.properties['picture:views'])}}"></a>
                    </div>
                  </li>
                </ol>
              </div>
            </div>
          </li>
        </ul>

        <div class="col-xl-12 col-md-12">
          <div *ngIf="showListView" class="card-view">
            <ul class="flexible">
              <li *ngFor="let image of images.slice(0, imageSliceInput); let i = index">
                <div class="cardBlock">
                  <div class="cardBlockContent">
                    <div class="row">
                      <div class="col-xl-6 col-md-6" style="position: relative;">
                        <p>{{image.properties['dc:title']}}</p>
                        <div class="username">
                          <span>
                            <img src="../../assets/images/card-small-pic.jpg">
                          </span>
                          {{image.properties['dc:creator'].id}}
                        </div>
                      </div>
                      <div (click)="open(preview, image)" class="col-xl-6 col-md-6">
                        <img src="{{getAssetUrl(image.contextParameters.thumbnail.url)}}" class="w-100 shadow-1-strong rounded" style="width: 100%;border-radius: 8px !important;" alt="" />
                        <!-- <img src="{{getAssetUrl(image.contextParameters.thumbnail.url)}}"
                          style="width: 100%;border-radius: 8px;"> -->
                      </div>
                    </div>
                  </div>
                  <div class="cardBlockContentHover">
                    <ol>
                      <li>
                        <div class="form-group-custom">
                          <input type="checkbox" id="html{{i}}" [checked]="image.isSelected" [(ngModel)]="image.isSelected" (change)="selectImage($event, image, i)">
                          <label for="html{{i}}"></label>
                        </div>
                      </li>
                      <li>
                        <div class="hover-icon-group">
                          <div class="hover-icon star-icon"></div>
                          <div class="hover-icon plus-icon" (click)="open(preview, image)"></div>
                          <a class="hover-icon download-icon" href="{{findOriginalUrlFromViews(image.properties['picture:views'])}}"></a>
                        </div>
                      </li>
                    </ol>
                  </div>
                </div>




                <!-- <div style="background-color: #F9F7F2;padding: 20px;">
                  <div class="row">
                    <div class="col-xl-6 col-md-6" style="position: relative;">
                      <p>{{image.properties['dc:title']}}</p>
                      <div class="username">
                        <span>
                          <img src="../../assets/images/user.png" style="width: 20px;">
                        </span>
                        <span>{{image.properties['dc:creator'].id}}</span>
                      </div>
                    </div>
                    <div class="col-xl-6 col-md-6">
                      <div (click)="open(preview, image)" class="listImg">
                        <img src="{{getAssetUrl(image.contextParameters.thumbnail.url)}}"
                          style="width: 100%;border-radius: 8px;">
                      </div>
                    </div>
                  </div>
                </div> -->
              
              
              
              
              </li>
            </ul>
          </div>
        </div>

        <div *ngIf="!hideImageShowMoreBtn" (click)="showMore('image')" style="text-align: center; cursor: pointer;">Show
          more</div>

        <!-- List view Images -->

        <!-- <div class="col-lg-4 mb-4 mb-lg-0">
        <img src="../../../assets/images/gallery-2.png" class="w-100 shadow-1-strong rounded mb-4" alt="" />
        <img src="../../../assets/images/gallery-img1.png" class="w-100 shadow-1-strong rounded mb-4" alt="" />
      </div>
      <div class="col-lg-4 mb-4 mb-lg-0">
        <img src="../../../assets/images/gallery-3.png" class="w-100 shadow-1-strong rounded mb-4" alt="" />

        <img src="../../../assets/images/gallery-2.png" class="w-100 shadow-1-strong rounded mb-4" alt="" />
      </div> -->

        <!-- Gallery -->
      </div>

      <div *ngIf="videos.length" class="row pt-5">
        <div class="col-xl-12 flexible" style="justify-content: space-between;">
          <p class="imgHead pb-4">Videos</p>
          <a class="fileCount pb-4">{{videos.length}} videos</a>
        </div>

        <div class="col-xl-12"> <!--  *ngIf="!showListView" -->
          <ul class="flexible videosList">
            <li *ngFor="let v of videos.slice(0, videoSliceInput)" class="">
              <a href="{{baseUrl}}/nuxeo/ui/#!/browse{{v.path}}">
                <img src="{{getAssetUrl(v.contextParameters.thumbnail.url)}}">
              </a>
            </li>
          </ul>
          </div>

          <!-- TODO: video card view -->
          <!-- <div class="col-xl-12 col-md-12">
            <div *ngIf="showListView" class="card-view">
              <ul class="flexible">
                <li *ngFor="let v of videos.slice(0, videoSliceInput); let i = index">
                  <div class="row">
                    <div class="col-xl-6 col-md-6" style="position: relative;">
                      <p>{{v.properties['dc:title']}}</p>
                      <div class="username">
                        <a href="{{baseUrl}}/nuxeo/ui/#!/browse{{v.path}}">
                          <img src="{{getAssetUrl(v.contextParameters.thumbnail.url)}}">
                        </a>
                        {{v.properties['dc:creator'].id}}
                      </div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
          </div> -->

          
          <div *ngIf="!hideVideoShowMoreBtn" (click)="showMore('video')" style="text-align: center; cursor: pointer;">
            Show
            more</div>

      </div>

      <div *ngIf="docs.length" class="row pt-5">
        <div class="col-xl-12 flexible" style="justify-content: space-between;">
          <p class="imgHead pb-4">Documents</p>
          <a class="fileCount pb-4" href="#">{{docs.length}} documents</a>
        </div>
        <div class="col-xl-12">
          <ul class="flexible docList">
            <li *ngFor="let doc of docs" class="">
              <a href="{{baseUrl}}/nuxeo/ui/#!/browse{{doc.path}}"><img
                  src="{{getAssetUrl(doc.contextParameters.thumbnail.url)}}"></a>
            </li>
          </ul>
        </div>

      </div>
    </div>
  </section>

  <ng-template #preview let-modal class="imgPopUpTab">
    <div class="modal-body ">
      <div class="modalHead">
        <div class="row flexible" style="justify-content: space-between;">
          <div class="col-xl-2 col-md-2">
            <!-- <img src="../../assets/images/User.svg" style="width: 50px;"> -->
            <img src="../../assets/images/black-user.png" style="width: 50px;">
            <span>{{selectedFile.properties['dc:creator'].id}}</span>
          </div>
          <div class="col-xl-4 col-md-4">
            <ul class="flexible">
              <li>
                <a placement="bottom" ngbTooltip="Favourites">
                  <img *ngIf="favourite" (click)="markFavourite(selectedFile, false)"
                    src="../../assets/images/yellow-star.svg">
                  <img *ngIf="!favourite" (click)="markFavourite(selectedFile, true)"
                    src="../../assets/images/star.svg">
                </a>
              </li>
              <li>
                <a placement="bottom" ngbTooltip="Add">
                  <img src="../../assets/images/add-circle.svg">
                </a>
              </li>
              <li>
                <a placement="bottom" ngbTooltip="Download">

                  <div ngbDropdown class="d-inline-block downloadDrop">
                    <a class="" id="dropdownBasic1" placement="bottom-left" ngbDropdownToggle><img
                        src="../../assets/images/Download.svg"></a>
                    <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
                      <a *ngFor="let view of selectedFile.properties['picture:views']" href="{{view.content.data}}"
                        style="color: white" ngbDropdownItem>{{view.width}} * {{view.height}}
                        <span>{{getDownloadFileEstimation(view.content.length)}}</span>
                      </a>
                    </div>
                  </div>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="popupTabSec">
        <img src="{{selectedFileUrl}}" style="width: 100%;">
        <div class="myTabContentMain" [ngClass]="{'hide': !showShadow}">
          <div class="tab-content myTabContent" id="myTabContent">
            <!-- use class myTabContent -->
            <div class="tab-pane fade show active" id="timeline" role="tabpanel" aria-labelledby="home-tab">
              <div class="timeline-content">
                <ul>
                  <li *ngFor="let log of selectedFile.contextParameters.audit">
                    <p><span>{{log.principalName}}</span> {{getEventString(log.eventId)}} {{getTime(log.eventDate,
                      false)}} ago</p>
                  </li>
                </ul>
              </div>
            </div>
            <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
              <div class="comment-content">
                <ul>
                  <li *ngFor="let comment of comments" class="flexible" style="align-items: unset;">
                    <div>
                      <img src="../../assets/images/User.svg">
                    </div>
                    <div>
                      <p>{{comment.author}} <span>{{getTime(comment.creationDate, false)}} ago</span></p>
                      <p>{{comment.text}}</p>
                    </div>
                  </li>
                </ul>
                <form (submit)="saveComment(commentText)">
                  <input type="text" [(ngModel)]="commentText" name="comment" placeholder="Write a comment here">
                </form>
              </div>
            </div>
            <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
              <div class="info-content">
                <div class="row">
                  <div class="col-xl-6 col-md-6">
                    <ul>
                      <li>
                        Created {{toDateString(selectedFile.properties['dc:created'])}} by
                        <span style="color: #EBC03F;">{{selectedFile.properties['dc:creator'].id}}</span>
                      </li>

                      <li>State <br>{{selectedFile.state}}</li>

                      <li>Version</li>

                      <li>Last Modified <br>{{toDateString(selectedFile.lastModified)}}</li>

                      <li>Contributors <br><span
                          style="color: #EBC03F;">{{getNames(selectedFile.properties['dc:contributors'])}}</span>
                      </li>

                      <li>
                        Dimensions <br>{{selectedFile.properties['picture:info'].width}} x
                        {{selectedFile.properties['picture:info'].height}}
                      </li>

                      <li>
                        Format <br>{{selectedFile.properties['picture:info'].format}}
                      </li>
                      <li>
                        Colour Profile <br>{{selectedFile.properties['picture:info'].colorSpace}}
                      </li>
                      <li>
                        Bit Depth per Channel <br>{{selectedFile.properties['picture:info'].depth}}
                      </li>
                      <li>
                        Weight <br>{{getDownloadFileEstimation(selectedFile.properties['file:content'].length)}}
                      </li>
                    </ul>
                  </div>
                  <div class="col-xl-6 col-md-6">
                    <ul>
                      <li>
                        Description <br>{{selectedFile.properties['dc:description'] ||
                        selectedFile.properties['imd:image_description']}}
                      </li>
                      <li>EXIF
                        <br>
                        Date {{selectedFile.properties['dc:created']}}
                        <br>
                        Orientation {{selectedFile.properties['imd:orientation']}}
                        <br>
                        Aperture {{selectedFile.properties['imd:fnumber']}}
                        <br>
                        Exposure {{selectedFile.properties['imd:exposure_time']}}
                        <br>
                        ISO {{selectedFile.properties['imd:iso_speed_ratings']}}
                        <br>
                        Focal Length {{selectedFile.properties['imd:focalLength']}}
                      </li>
                      <li>IPTC
                        <br>
                        Copyright {{selectedFile.properties['imd:copyright']}}
                        <br>
                        Rights {{selectedFile.properties['dc:rights']}}
                        <br>
                        Source {{selectedFile.properties['picture:source']}}
                        <br>
                        Description {{selectedFile.properties['dc:description']}}
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="sub-body-modal flexible" style="justify-content: space-between; align-items: unset;">
        <div class="mb-5 mb-2" style="width: 70%">
          <span class="main-heading">{{selectedFile.properties['dc:description']}}</span>
          <span class="yellowBtn">Internal Use Â©</span>
        </div>
        <div class="flexible" style="align-items: unset;">
          <ul class="nav nav-tabs iconsList iconsTab" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
              <a class="nav-link active" placement="bottom" ngbTooltip="Timeline" id="home-tab" data-bs-toggle="tab"
                (click)="openInfo('timeline')" href="#timeline" role="tab" aria-controls="home"
                aria-selected="true"><img src="../../assets/images/clock.svg"></a>

            </li>
            <li class="nav-item" role="presentation">
              <a class="nav-link" id="profile-tab" placement="bottom" ngbTooltip="Comments" data-bs-toggle="tab"
                (click)="openInfo('comments')" href="#profile" role="tab" aria-controls="profile"
                aria-selected="false"><img src="../../assets/images/Comments.svg"></a>
            </li>
            <li class="nav-item" role="presentation">
              <a class="nav-link" id="contact-tab" placement="bottom" ngbTooltip="Info" data-bs-toggle="tab"
                (click)="openInfo('info')" href="#contact" role="tab" aria-controls="contact" aria-selected="false">
                <img src="../../assets/images/Info.svg"></a>
            </li>
          </ul>

          <ul class="iconsList">
            <li>
              <a>
                <div ngbDropdown class="d-inline-block downloadDrop settingsDropdown">
                  <a class="" id="dropdownBasic2" placement="bottom-left" ngbDropdownToggle><img
                      src="../../assets/images/threedots.svg" style="height: 18px;"></a>
                  <div ngbDropdownMenu aria-labelledby="dropdownBasic2">
                    <a ngbDropdownItem>Share</a>
                    <a ngbDropdownItem>Publish file</a>
                    <a ngbDropdownItem>Stop notifications</a>
                    <a ngbDropdownItem>Add to clipboard</a>
                    <a ngbDropdownItem>Export</a>
                    <a ngbDropdownItem>Start process</a>
                    <a ngbDropdownItem>Replace file</a>
                    <a ngbDropdownItem>Delete file</a>
                  </div>
                </div>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </ng-template>

  <div *ngIf="fileSelected.length" class="footer-listing">
    <div class="row">
      <div class="col-md-4 footer-add-items">
        <span>{{fileSelected.length}} item(s) selected</span>
        <a (click)="clearSelected()">Clear</a>
      </div>
      <div class="col-md-4">
        <img src="../../assets/images/synchronize-arrow-clock-footer.svg" alt="" class="footer-icons">
        <img src="../../assets/images/synchronize-arrow-clock-footer-1.svg" alt="" class="footer-icons">
      </div>
      <div class="col-md-4">
        <img src="../../assets/images/download-all-as-zip.svg" placement="top" ngbTooltip="Download all as zip" alt="" class="footer-icons">
        <img src="../../assets/images/plus-footer.svg" alt="" class="footer-icons" placement="top" ngbTooltip="Add to collections ">
        <img src="../../assets/images/copy-footer.svg" alt="" class="footer-icons" placement="top" ngbTooltip="Add to clipboard">
        <img src="../../assets/images/upload-footer.svg" alt="" class="footer-icons" placement="top" ngbTooltip="Publish document">
        <img src="../../assets/images/delete-footer.svg" alt="" class="footer-icons" style="height: 30px;" placement="top" ngbTooltip="Delete item(s)">
      </div>
    </div>
  </div>

</section>