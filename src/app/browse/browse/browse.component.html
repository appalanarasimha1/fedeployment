<section class="sub-header" style="background-color: #E8E6DF;background-image: unset;">

</section>
<app-loader [show]="loading"></app-loader>
<section  style="background-color: #E8E6DF;padding: 30px 0px;">
  <div class="container-fluid">
    <div class="row">
      <div class="col-xl-12">
        <h2 class="commonHeading" style="font-weight: 600;">Workspace</h2>
      </div>
    </div>
  </div>
</section>
<section style="background-color: #F1EFE0;" class="lpBAck">
  <section class="lpSecOne">
    <div class="container-fluid">
      <div class="row" style="min-height: 600px;">
        <div class="col-xl-3 col-md-3 pt-3 " style="background-color: #F8F8F5;">
           <div class="tree" style="margin: 0px -11px;">
            <!-- <div class="tree__tree-section"> -->
              <ul style="list-style: none;" class="leftPanel">
                <li *ngFor="let item of folderStructure;let i = index" style="cursor: pointer">
                  <div class="d-flex set" [ngClass]="selectedFolder.uid === item.uid ? 'active-tab' : ''" (click)="handleClick(item, i);selectedFolder=item;">
                    <div >
                      <fa-icon [icon]="['fas', 'angle-down']" *ngIf="item.isExpand"></fa-icon>
                      <fa-icon [icon]="['fas', 'angle-right']" *ngIf="!item.isExpand"></fa-icon>
                    </div>
                    <span style="padding-left: 10px;" >{{item.title}}</span>
                  </div>
                  <ul *ngIf="item.children && item.isExpand" class="leftPanel ">
                    <li  *ngFor="let firstChild of item.children;let fIndex = index"  style="cursor: pointer">
                      <div class="d-flex set paddingLeft" [ngClass]="selectedFolder.uid === firstChild.uid ? 'active-tab' : ''" (click)="handleClick(firstChild, i, fIndex);selectedFolder=firstChild; routeParams.folder = null">
                        <div class="">
                          <fa-icon [icon]="['fas', 'angle-down']" style="font-size: 20px;" *ngIf="firstChild.isExpand">
                          </fa-icon>
                          <fa-icon [icon]="['fas', 'angle-right']" *ngIf="!firstChild.isExpand" style="font-size: 20px;">
                          </fa-icon>
                        </div>
                        <span style="padding-left: 10px;"
                          >{{firstChild.title}}</span>
                      </div>
                      <ul *ngIf="firstChild.children && firstChild.isExpand" class="leftPanel">
                        <li *ngFor="let secondChild of firstChild.children;let sIndex = index"  style="cursor: pointer">
                          <div class="d-flex set paddingLeft1" [ngClass]="selectedFolder.uid === secondChild.uid ? 'active-tab' : ''" (click)="handleTest(secondChild);selectedFolder=secondChild;">
                            <div>
                              <img src="../../../assets/images/folderBlack.png" style="font-size: 20px;" *ngIf="selectedFolder.uid !== secondChild.uid">
                              <!-- <fa-icon [icon]="['fas', 'folder']" style="font-size: 20px;"
                                *ngIf="selectedFolder.uid !== secondChild.uid"></fa-icon> -->
                                <img src="../../../assets/images/folder-openblack.png" style="font-size: 20px;" *ngIf="selectedFolder.uid === secondChild.uid">
                              <!-- <fa-icon [icon]="['fas', 'folder-open']" *ngIf="selectedFolder.uid === secondChild.uid"
                                style="font-size: 20px;"></fa-icon> -->
                            </div>
                            <span style="padding-left: 10px;" >{{secondChild.title}}</span>
                          </div>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </li>
              </ul>
            </div>
          <!-- </div> -->
        </div>
        <div class="col-xl-9 col-md-9 p-5 pt-5 bg-white">
          <div *ngIf="selectedFolder">
            <div class="header-content">
              <div>
                <h3>{{selectedFolder?.title}}</h3>
                <h6>{{breadcrrumb.replace("/Workspaces", "")}}</h6>
              </div>
              <div class="views">
                <a class="update-classifications-btn pb-3" *ngIf="checkShowUpdateBtn()" (click)="openUpdateClassModal()">Update classifications</a>
                <div>
                  <img src="../../../assets/images/gallery view.png" class="menu-icon" [ngClass]="selectedMenu === 0 ? 'active' : '' "
                  (click)="handleSelectMenu(0, 'GRID')">
                    <img src="../../../assets/images/list view.png" class="menu-icon" [ngClass]="selectedMenu === 1 ? 'active' : '' "
                    (click)="handleSelectMenu(1, 'LIST')">
                </div>
              </div>
            </div>
            <div class="main-content" *ngIf="selectedMenu === 0">
              <div class="col-xl-12 col-md-12" *ngIf="searchList && searchList.length">
                <ngx-masonry [options]="myOptions" [ordered]="true" (layoutComplete)="completeLoadingMasonry($event)"
                  [updateLayout]="updateMasonryLayout">
                  <div ngxMasonryItem class="masonry-item" style="display: inline-block;margin-right: 10px; cursor: pointer;" *ngFor="let item of searchList; let i = index">
                    <span class="folderCircle" (click)="handleViewClick(item, i);selectedFolder=item;"
                      *ngIf="!checkAssetType(item.type) && !checkWSType(item.type)">{{item.title}}</span>
                    <div *ngIf="!checkAssetType(item.type) && checkWSType(item.type)" class="folder-structure" style="border-radius: 8px; cursor: pointer;"
                      (click)="handleTest(item);selectedFolder=item;">
                      <img src="../../../assets/images/yellow-folder.png">
                      <div class="folder-content" style="background-color: #F9F7F2;">
                        <p>{{item.title}}</p>
                        <span>{{ getFolderInfo(item) }}</span>
                      </div>
                    </div>
                    <document-card *ngIf="checkAssetType(item.type)"
                      [doc]="item"
                      [viewType]="viewType"
                      (onOpenPreview)="open(item, item.type)"
                      (onSelect)="selectImage($event, item, i)"
                      (onMarkFavourite)="markFavourite(item, false)"
                      >
                    </document-card>

                  </div>
                </ngx-masonry>
              </div>

              <div class="block-container" *ngFor="let item of searchList">

                <div class="hover-content">
                  <div class="left-content">
                    <fa-icon [icon]="['fas', 'check-circle']" class="menu-icon active"></fa-icon>
                  </div>
                  <div class="right-content">
                    <div>
                      <div>
                        <fa-icon [icon]="['fas', 'star']" class="hover-menu-icon"></fa-icon>
                      </div>
                      <div>
                        <fa-icon [icon]="['fas', 'plus-circle']" class="hover-menu-icon"></fa-icon>
                      </div>
                    </div>
                    <div class="right-bottom-content">
                      <fa-icon [icon]="['fas', 'download']" class="hover-menu-icon"></fa-icon>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row justify-content-between" *ngIf="selectedMenu === 1">
              <div class="col-xl-6 col-md-6 row list-container" *ngFor="let item of searchList; let i = $index">
                <div *ngIf="!checkAssetType(item.type)">
                  <div class="list-image col-xl-2 col-md-2">
                    <fa-icon [icon]="['fas', 'image']" class="icons"></fa-icon>
                  </div>
                  <div class="col-xl-10 col-md-10">
                    <h5 class="list-title">{{item.title}}</h5>
                    <h6>Created by {{item.properties['dc:creator']}}</h6>
                  </div>
                </div>

                <document-card *ngIf="checkAssetType(item.type)"
                  [doc]="item"
                  [viewType]="viewType"
                  (onOpenPreview)="open(item, item.type)"
                  (onSelect)="selectImage($event, item, i)"
                  (onMarkFavourite)="markFavourite(item, false)"
                  >
                </document-card>
              </div>
            </div>
            <div class="main-content" *ngIf="selectedMenu === 2">
              <div class="col-xl-12 col-md-12 row list-container" *ngFor="let item of searchList">
                  <h5 class="list-title">{{item.title}}</h5>
                  <h6 class="mt-2">By  <fa-icon [icon]="['fas', 'user-circle']" class="person-icons"></fa-icon> {{item.properties['dc:creator']}}</h6>
              </div>
            </div>

            <preview-popup #previewModal [doc]="selectedFile" [docUrl]="selectedFileUrl"></preview-popup>
          </div>
        </div>
      </div>
    </div>

  </section>

</section>
<button mat-fab class="float" color="primary" aria-label="Add" (click)="openUpdateClassModal()">
  <mat-icon>add</mat-icon>
</button>