<app-sub-header></app-sub-header>
<section style="background-color: #fff;" class="lpBAck">
  <section class="lpSecOne ">
    <div class="container">

      <div class="row ">
        <div class="col-xl-3 col-md-3 pt-2 customToggle pt-5 animate__animated animate__fadeIn animate__delay-2s" style="background-color: #F8F8F5;">
          <div class="pb-5 pl-12">
            <h2 class="commonHeading main-title" style="font-weight: normal">
              Settings
            </h2>
          </div>
          <div class="tree">
            <ul style="list-style: none" class="leftPanel">
              <li
                style="cursor: pointer"
                class="d-flex set"
                (click)="fetchManagedExternalUsers()"
                [ngClass]="{'active-tab': showUserSettingPage || showUserAccessPage}"
              >
                <span>Manage external users</span>
              </li>
            </ul>
          </div>
        </div>
        <div
          class="col-xl-9 col-md-9 pl-5 pt-5 pb-5 bg-white positionRelative"
          style="min-height: 100vh"
        >
          <app-loader [show]="loading"></app-loader>
          <div *ngIf="showUserSettingPage" class="externalUser">
            <h2>Manage external users</h2>
            <p class="externalEditAccess">Hover over a user to edit their access.</p>
            <div class="searchBlock">
              <button class="primary search-btn">
                <svg width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.5404 18.8025C18.6351 17.0622 20.5438 12.332 18.8036 8.23728C17.0634 4.14253 12.3332 2.2338 8.23843 3.97403C4.14367 5.71426 2.23495 10.4445 3.97518 14.5392C5.71541 18.634 10.4456 20.5427 14.5404 18.8025Z" stroke="#040404" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M17.0854 17.084L23.3334 23.3329" stroke="#040404" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              <input
                type="text"
                placeholder="Search users by their name or email address"
                class="search-bar"
              />
            </div>
            <div class="makeAdminBlock">
              <ul>
                <li *ngFor="let user of managedUsers; let i = index">
                  {{user}}
                  <span class="makeAdminAction">
                    <span (click)="openEditUserAccess(user)" >Edit access</span>
                    <span (click)="removeAllAccess(user)" class="removeIcon">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M10 20C4.477 20 0 15.523 0 10C0 4.477 4.477 0 10 0C15.523 0 20 4.477 20 10C20 15.523 15.523 20 10 20ZM10 18C12.1217 18 14.1566 17.1571 15.6569 15.6569C17.1571 14.1566 18 12.1217 18 10C18 7.87827 17.1571 5.84344 15.6569 4.34315C14.1566 2.84285 12.1217 2 10 2C7.87827 2 5.84344 2.84285 4.34315 4.34315C2.84285 5.84344 2 7.87827 2 10C2 12.1217 2.84285 14.1566 4.34315 15.6569C5.84344 17.1571 7.87827 18 10 18ZM10 8.586L12.828 5.757L14.243 7.172L11.414 10L14.243 12.828L12.828 14.243L10 11.414L7.172 14.243L5.757 12.828L8.586 10L5.757 7.172L7.172 5.757L10 8.586Z"
                          fill="#937206"
                        />
                      </svg>
                      <div class="removeInfo">Remove user from all of my private folders</div>
                    </span>
                  </span>
                </li>
              </ul>
            </div>
          </div>
          <div *ngIf="showUserAccessPage" class="showUserAccess customTableStyle">
            <div class="backBtn">
              <span (click)="backToUserList();">
                <svg width="8" height="14" viewBox="0 0 8 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M2.828 7.00072L7.778 11.9507L6.364 13.3647L0 7.00072L6.364 0.636719L7.778 2.05072L2.828 7.00072Z" fill="#BAB8B2"/>
                </svg> Back</span>
            </div>
            <h3>Edit access</h3>
            <h2>{{currentEditingUser}}</h2>
            <h3><img src="../../assets/images/private-icon.svg" class="private-icon" /> Private folder access <!--span class="addUserPrivate" (click)="openAddUserPrivateFolderModal()">Add user to a new private folder</span--></h3>
            <p class="externalEditAccess">This user has access to these folders. Here you can edit permission and access of this user.</p>
            <table class="folderListview pb-5">
              <tr>
                <th style="width: 2%" class="checkAll positionRelative">&nbsp;&nbsp;</th>
                <th width="50%">Folder name</th>
                <!-- <th width="25%">
                  Permissions
                  <div class="tollTipCustom" style="display: inline-block;">
                    <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" class="private-icon">
                      <path d="M18 0C8.06858 0 0 8.07848 0 18.0064C0 27.9343 8.06858 36 18 36C27.9315 36 36 27.9343 36 18.0064C36 8.07848 27.9315 0 18 0H18ZM18 1.64855C27.0471 1.64855 34.3636 8.9625 34.3636 18.0064C34.3636 27.0503 27.0471 34.3515 18 34.3515C8.95292 34.3515 1.63636 27.0503 1.63636 18.0064C1.63636 8.9625 8.95292 1.64855 18 1.64855H18ZM18 9.00956C17.5481 9.00956 17.1818 9.37573 17.1818 9.82745C17.1818 10.2792 17.5481 10.6454 18 10.6454C18.4519 10.6454 18.8182 10.2792 18.8182 9.82745C18.8182 9.37573 18.4519 9.00956 18 9.00956ZM17.9105 13.0863C17.7072 13.1086 17.5196 13.2063 17.3847 13.36C17.2498 13.5138 17.1774 13.7125 17.1818 13.9169V26.1853C17.1803 26.2937 17.2003 26.4013 17.2407 26.5019C17.2812 26.6024 17.3412 26.694 17.4173 26.7712C17.4935 26.8483 17.5842 26.9096 17.6842 26.9515C17.7842 26.9933 17.8916 27.0148 18 27.0148C18.1084 27.0148 18.2158 26.9933 18.3158 26.9515C18.4158 26.9096 18.5065 26.8483 18.5827 26.7712C18.6588 26.694 18.7188 26.6024 18.7593 26.5019C18.7997 26.4013 18.8197 26.2937 18.8182 26.1853V13.9169C18.8207 13.8005 18.7983 13.6849 18.7525 13.5778C18.7067 13.4707 18.6386 13.3746 18.5526 13.296C18.4667 13.2173 18.365 13.158 18.2542 13.1218C18.1435 13.0856 18.0263 13.0735 17.9105 13.0863Z" fill="#BAB8B2"/>
                    </svg>
                    <div class="tolltipContent" style="top: 32px; left: auto; right: 0px; padding: 2px 10px;">
                      dummy content place here..
                    </div>
                  </div>
                </th> -->
                <th width="15%">
                  Asset expiry
                  <div class="tollTipCustom" style="display: inline-block;">
                    <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" class="private-icon">
                      <path d="M18 0C8.06858 0 0 8.07848 0 18.0064C0 27.9343 8.06858 36 18 36C27.9315 36 36 27.9343 36 18.0064C36 8.07848 27.9315 0 18 0H18ZM18 1.64855C27.0471 1.64855 34.3636 8.9625 34.3636 18.0064C34.3636 27.0503 27.0471 34.3515 18 34.3515C8.95292 34.3515 1.63636 27.0503 1.63636 18.0064C1.63636 8.9625 8.95292 1.64855 18 1.64855H18ZM18 9.00956C17.5481 9.00956 17.1818 9.37573 17.1818 9.82745C17.1818 10.2792 17.5481 10.6454 18 10.6454C18.4519 10.6454 18.8182 10.2792 18.8182 9.82745C18.8182 9.37573 18.4519 9.00956 18 9.00956ZM17.9105 13.0863C17.7072 13.1086 17.5196 13.2063 17.3847 13.36C17.2498 13.5138 17.1774 13.7125 17.1818 13.9169V26.1853C17.1803 26.2937 17.2003 26.4013 17.2407 26.5019C17.2812 26.6024 17.3412 26.694 17.4173 26.7712C17.4935 26.8483 17.5842 26.9096 17.6842 26.9515C17.7842 26.9933 17.8916 27.0148 18 27.0148C18.1084 27.0148 18.2158 26.9933 18.3158 26.9515C18.4158 26.9096 18.5065 26.8483 18.5827 26.7712C18.6588 26.694 18.7188 26.6024 18.7593 26.5019C18.7997 26.4013 18.8197 26.2937 18.8182 26.1853V13.9169C18.8207 13.8005 18.7983 13.6849 18.7525 13.5778C18.7067 13.4707 18.6386 13.3746 18.5526 13.296C18.4667 13.2173 18.365 13.158 18.2542 13.1218C18.1435 13.0856 18.0263 13.0735 17.9105 13.0863Z" fill="#BAB8B2"/>
                    </svg>
                    <div class="tolltipContent" style="top: 32px; left: auto; right: 0px; padding: 2px 10px;">
                      dummy content place here..
                    </div>
                  </div>
                </th>
                <th style="width: 5%">&nbsp;&nbsp;</th>
              </tr>
              <tr *ngFor="let item of currentUserFolderList; let i = index" class="groupFolder positionRelative">
                <td style="position: relative;">
                  <div class="delete-folder-action">
                    <div class="control-group">
                      <label class="control control--checkbox">
                        <input class="chkbox"
                          id="checkbox-{{ i }}"
                          type="checkbox"
                        />
                        <div class="control__indicator"></div>
                      </label>
                    </div>
                  </div>
                </td>
                <td class="positionRelative pointerCursor">
                  <img src="../../assets/images/folder-table-list.svg">
                  <p style="text-align: left; word-break: break-all;display: inline-block;
                  vertical-align: middle;">
                    <span class="tollTipCustom">
                      {{sharedService.stringShortener(item?.title, 25)}}
                      <span class="tolltipContent" style="top: 28px;
                      height: auto;
                      white-space: break-spaces;
                      text-align: left;
                      padding: 5px 10px; max-width: 100vh;">
                        {{item.title}}
                      </span>
                    </span>

                  </p>
                  <span style="display: inline-block; margin-left: 10px; vertical-align: top; position: relative;">
                    <div class="publicUseBlock">
                      <div class="tollTipCustom">
                        <img src="../../assets/images/private-icon.svg" class="private-icon" />
                        <div class="tolltipContent" style="top: 28px;
                        height: auto;
                        white-space: break-spaces;
                        text-align: left;
                        padding: 5px 10px;">
                          This is a private folder
                        </div>
                      </div>
                    </div>
                  </span>
                </td>
                <!-- <td>
                  <ul>
                    <li>
                      <div class="broader-access-assets">
                        <div class="control-group">
                          <label class="control control--checkbox">
                            <input class="chkbox" type="checkbox"/>
                            <div class="control__indicator"></div>
                            Upload
                          </label>
                        </div>
                      </div>
                    </li>
                    <li>
                      <div class="broader-access-assets">
                        <div class="control-group">
                          <label class="control control--checkbox">
                            <input class="chkbox" type="checkbox"/>
                            <div class="control__indicator"></div>
                            Download
                          </label>
                        </div>
                      </div>
                    </li>
                  </ul>
                </td> -->
                <td>
                  <!-- <p>{{item.end}}</p> -->

                  <mat-form-field appearance="fill">
                    <input matInput [formControl]="calculateEndDate(item.end)" (dateChange)="onEndDateChange($event.value, item, i)" [matDatepicker]="picker" style="width: 100%; border-bottom: 1.5px solid #000;" (click)="picker.open()">
                    <mat-datepicker [startAt]="calculateEndDate(item.end)" #picker></mat-datepicker>
                  </mat-form-field>
                </td>
                <td style="text-align: center !important;">
                  <div class="tollTipCustom" style="display: inline-block;">
                    <img src="../../assets/images/delete-icon.svg" (click)="removePermission(item, i)" style="cursor: pointer;" />
                    <div class="tolltipContent" style="top: 32px; left: auto; right: 0px; padding: 2px 10px;">
                      Remove access to this folder
                    </div>
                  </div>
                </td>
              </tr>
            </table>

            <!-- <h3 class="mt-30"><img src="../../assets/images/broader-access-icon.svg" class="private-icon" /> Broader access </h3>
            <p class="externalEditAccess">In addition to the private folders above, set the user to have access to public assets in other folders.</p>

            <div class="broader-access-assets">
              <div class="control-group">
                <label class="control control--checkbox">
                  <input class="chkbox" type="checkbox"/>
                  <div class="control__indicator"></div>
                  Broader access to all public assets
                </label>
              </div>
            </div> -->
          </div>
        </div>
      </div>
    </div>
  </section>
</section>
